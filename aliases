alias docker-run="docker run --rm -it -v ${HOME}:/root -w /root/${PWD#$HOME} --entrypoint"
alias destroy-base="docker image rm main-tools:latest"
function debug-base() { destroy-base ; set-base && docker run --rm --entrypoint bash -it main-tools ; }

function versioning() {
	[ -v $TF_VERSION ] && TF_VERSION=latest || TF_VERSION=$TF_VERSION ; echo "TF_VERSION=$TF_VERSION" ;
}

function set-base() {	
	versioning ;
	if [[ "$(docker images -q main-tools:latest 2> /dev/null)" == "" ]]; then
	printf " FROM hashicorp/terraform:$TF_VERSION
		 RUN apk update
		 RUN apk add make
		 RUN apk add bash
               " > Dockerfile
	docker build --no-cache -t main-tools:latest . && rm Dockerfile
	fi
}

# TERRAFORM #
function terraform() {
	set-base ;
	docker-run terraform -e TF_LOG=$TF_LOG -e AWS_PROFILE=$AWS_PROFILE main-tools ${@} ;
}

# GIT #
function git() {
	set-base ;
	docker-run git main-tools ${@} ; 
}
